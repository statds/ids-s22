
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>10.5. Support Vector Machines &#8212; Introduction to Data Science, Spring 2022</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="10.16. K Nearest Neighbor" href="nearest_neighbor.html" />
    <link rel="prev" title="10.4. Bagging versus Boosting" href="bagging_vs_boosting.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/tricircle.pdf" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Data Science, Spring 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   2. Markdown Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prman.html">
   3. Project Management
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="module.html">
   4. Building a Python Module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="refresh.html">
   5. Python Refreshment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scipy.html">
   6. SciPy for Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pandas.html">
   7. Data Manipulation with Pandas
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="visual.html">
   8. Visualization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="matplotlib.html">
     8.1. Matplotlib: Visualization with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="plotnine.html">
     8.2. Plotnine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cartopy.html">
     8.3. Cartopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gmplot.html">
     8.4. GM Plot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bokeh.html">
     8.5. Interactive Visualizations Using Bokeh
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="statmodels.html">
   9. Statistical Tests and Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="patsy.html">
     9.1. Describing Models with Patsy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tests.html">
     9.2. Hypothesis Tests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="models.html">
     9.3. Linear and Generalized Linear Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gams.html">
     9.5. Generalized Additive Models
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="supervised.html">
   10. Supervised Learning
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="decisiontrees.html">
     10.2. Decision Trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="randomforests.html">
     10.3. Random Forests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bagging_vs_boosting.html">
     10.4. Bagging versus Boosting
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     10.5. Support Vector Machines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nearest_neighbor.html">
     10.16. K Nearest Neighbor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="XGBoost.html">
     10.17. XGBoost
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Tensorflow.html">
     10.19. Tensorflow
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="unsupervised.html">
   11. Unsupervised Learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="k_means_clustering.html">
     11.1. K-means Clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="GMM.html">
     11.2. Gaussian Mixture Models
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="miscellaneous.html">
   12. Miscellaneous
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="web_scraping.html">
     12.1. Web Scraping with Beautiful Soup
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exercises.html">
   13. Exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fixedit.html">
   14. I Fixed It
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back.html">
   15. Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/docs/svm.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/svm.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/statds/ids-s22/master?urlpath=tree/notes/docs/svm.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   10.5. Support Vector Machines
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-scikit-learn">
   10.6. Install scikit-learn
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concepts">
   10.7. Concepts
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kernel-svm">
   10.8. Kernel SVM
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kernel">
     10.8.1. Kernel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advantages-and-disadvantages">
   10.9. Advantages and Disadvantages
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exectution-within-python">
   10.10. Exectution within python
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#support-vectors">
   10.11. Support Vectors
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-support-vector-machines">
   10.12. Other Support Vector Machines
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#misclassification">
   10.13. Misclassification
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#in-practice">
   10.14. In Practice
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#for-additional-info">
   10.15. For Additional Info
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Support Vector Machines</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   10.5. Support Vector Machines
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-scikit-learn">
   10.6. Install scikit-learn
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concepts">
   10.7. Concepts
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kernel-svm">
   10.8. Kernel SVM
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kernel">
     10.8.1. Kernel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advantages-and-disadvantages">
   10.9. Advantages and Disadvantages
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exectution-within-python">
   10.10. Exectution within python
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#support-vectors">
   10.11. Support Vectors
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-support-vector-machines">
   10.12. Other Support Vector Machines
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#misclassification">
   10.13. Misclassification
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#in-practice">
   10.14. In Practice
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#for-additional-info">
   10.15. For Additional Info
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="support-vector-machines">
<h1><span class="section-number">10.5. </span>Support Vector Machines<a class="headerlink" href="#support-vector-machines" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>Support vector machines (SVM) is a supervised machine learning technique. And, even though it’s mostly used in classification, it can also be applied to regression problems.</p>
</div></blockquote>
<blockquote>
<div><p>SVMs define a decision boundary along with a maximal margin that separates almost all the points into two classes. While also leaving some room for misclassifications.</p>
</div></blockquote>
</div>
<div class="section" id="install-scikit-learn">
<h1><span class="section-number">10.6. </span>Install scikit-learn<a class="headerlink" href="#install-scikit-learn" title="Permalink to this headline">¶</a></h1>
<p>To install this library, run this pip command:
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">scikit-learn</span></code>.</p>
</div>
<div class="section" id="concepts">
<h1><span class="section-number">10.7. </span>Concepts<a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h1>
<p>Consider a two-class classification problem.
Suppose that the observed data are</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\{X_i, Y_i: i = 1, \ldots, n\},
\end{equation*}\]</div>
<p>where the labels <span class="math notranslate nohighlight">\(y_i \in \{1, -1\}\)</span>, indicating different classes,
and <span class="math notranslate nohighlight">\(X_i\)</span>’s are <span class="math notranslate nohighlight">\(p\)</span>-dimensional feature vectors.
Intuitively, a good separation is achieved by the hyper-plane that has the
largest distance to the nearest training data points of any class (so-called
functional margin), since in general the larger the margin the lower the
generalization error of the classifier. In other words,
we want to find a separation hyperplane that maximizes the margin
between the two classes, where the margin is defined as the mimum distance
between the data instances and the decision boundary.</p>
<p>A hyperplane in the <span class="math notranslate nohighlight">\(p\)</span>-dimension space is defined by a normal vector <span class="math notranslate nohighlight">\(w\)</span> and
scalar constant <span class="math notranslate nohighlight">\(b\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
w^\top x- b = 0.
\end{equation*}\]</div>
<p>For identification, we assumed that <span class="math notranslate nohighlight">\(w\)</span> is normalized (so that it has unit length).
Suppose for the moment that the two classes can be perfectly separated by a
hyperplane. One could use two boundaries</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
 w^\top x - b &amp; =  1,\\
 w^\top x - b &amp; = -1.
\end{align*}\]</div>
<p>Anything above the first boundary is labeled 1, and anything below the second
boundary is labeled <span class="math notranslate nohighlight">\(-1\)</span>.
Geometrically we want to maximize the distance between the boundaries,
which is <span class="math notranslate nohighlight">\(2 / \| w\|\)</span>; see <a class="reference external" href="https://math.stackexchange.com/q/1305925/168764">why</a>.</p>
<p>We also want to prevent points from falling into the margin, so we add the constraints:
<span class="math notranslate nohighlight">\(w^\top x_i-b\ge1, \ Y_i=1\)</span> and <span class="math notranslate nohighlight">\(w^\top X_i-b\le-1, \ Y_i=-1\)</span>.
They can be written as</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
Y_i (w^\top X_i - b) \ge 1, \ i = 1, \ldots, n.
\end{equation*}\]</div>
<p>The optimization for linear SVM is:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\min_{w, b} \ &amp;\frac{1}{2} \|w\|^2  \\
\text{s.t  } \ &amp; y_i(w^\top x_i-b)\ge 1.
\end{align*}\]</div>
<p>The loss function is (known as hard-margin):</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{1}{2}\|w\|^2+ C \sum_i {[1 -Y_i(w^\top X_i - b)]}.
\end{equation*}\]</div>
<p>Recall that we have assumed that the data is linearly separable. What if it’s
not? We can relax the constrains slightly by some <span class="math notranslate nohighlight">\(\zeta_i &gt; 0\)</span>
(known as soft-margin):</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\min_{w, b, \zeta} &amp; \frac{1}{2}\|w\|^2 + C \sum_i \zeta_i\\
\text{s.t. }
&amp;Y_i (w^\top X_i - b) \ge 1 - \zeta_i,\\
&amp;\zeta_i \ge 0, \ i = 1, \ldots, n.
\end{align*}\]</div>
<!-- The lagrangian dual of the above is: -->
<!-- $$ -->
<!-- \max f(c_1,...,c_n)=\sum_i{c_i}-\frac{1}{2}\sum_i\sum_j {y_ic_i(x_i^Tx_j)y_jc_j}\\ -->
<!-- \text{s.t  } \sum_i{c_iy_i}=0, 0\le c_i\le1/2n\lambda -->
<!-- $$ -->
<p>Why are the support vectors called support vectors?
See <a class="reference external" href="https://towardsdatascience.com/so-why-the-heck-are-they-called-support-vector-machines-52fc72c990a1">this
blog</a>.</p>
</div>
<div class="section" id="kernel-svm">
<h1><span class="section-number">10.8. </span>Kernel SVM<a class="headerlink" href="#kernel-svm" title="Permalink to this headline">¶</a></h1>
<p>Sometimes the data cannot be separate by a hyperplane. A nonlinear classifier
can be created by applying the kernel trick. In particular, we replace <span class="math notranslate nohighlight">\(X_i\)</span> by
a transformation of it; and replace the inner product by a Kernel defined on the
transformed space. The classification vector in the transformed space is
$<span class="math notranslate nohighlight">\(\sum{c_i Y_i \phi(X_i)}. \)</span>$</p>
<p>Check the different SVM methods with different decision functions <a class="reference external" href="https://scikit-learn.org/stable/modules/svm.html#mathematical-formulation">here</a>!</p>
<div class="section" id="kernel">
<h2><span class="section-number">10.8.1. </span>Kernel<a class="headerlink" href="#kernel" title="Permalink to this headline">¶</a></h2>
<p>Kernels are symmetric functions in the form <span class="math notranslate nohighlight">\(K(x,y)\)</span>.
Examples of kernels:</p>
<ul class="simple">
<li><p>Linear kernel: <span class="math notranslate nohighlight">\(K(x,y)=x^Ty\)</span></p></li>
<li><p>Gaussian kernel (RBF):
<span class="math notranslate nohighlight">\(K(x,y)=e^{-\frac{||x-y||^2}{2\sigma^2}}=e^{-\gamma||x-y||^2}\)</span></p></li>
<li><p>Laplacian kernel: <span class="math notranslate nohighlight">\(K(x,y)=e^{-\alpha||x-y||}\)</span></p></li>
</ul>
<p>In <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>, we can apply kernelized SVM by changing linear kernel to RBF
kernel easily. There are two parameters in RBF kernel: <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span>. They
are related to the smooth of decision surface and influence of single training
sample. A <a class="reference external" href="https://scikit-learn.org/stable/modules/svm.html#kernel-functions">gridsearch
cross-validation</a> can be
used to decide these parameters.</p>
</div>
</div>
<div class="section" id="advantages-and-disadvantages">
<h1><span class="section-number">10.9. </span>Advantages and Disadvantages<a class="headerlink" href="#advantages-and-disadvantages" title="Permalink to this headline">¶</a></h1>
<p>The advantages of support vector machines are:</p>
<ul class="simple">
<li><p>Effective in high dimensional spaces.</p></li>
<li><p>Still effective in cases where number of dimensions is greater than the number of samples.</p></li>
<li><p>Uses a subset of training points in the decision function (called support vectors), so it is also memory efficient.</p></li>
<li><p>Versatile: different Kernel functions can be specified for the decision function. Common kernels are provided, but it is also possible to specify custom kernels.</p></li>
</ul>
<p>The disadvantages of support vector machines include:</p>
<ul class="simple">
<li><p>If the number of features is much greater than the number of samples, avoid over-fitting in choosing Kernel functions and regularization term is crucial.</p></li>
<li><p>SVMs do not directly provide probability estimates, these are calculated using an expensive five-fold cross-validation (see Scores and probabilities, below).</p></li>
</ul>
<p>Source: https://scikit-learn.org/stable/modules/svm.html#svm</p>
</div>
<div class="section" id="exectution-within-python">
<h1><span class="section-number">10.10. </span>Exectution within python<a class="headerlink" href="#exectution-within-python" title="Permalink to this headline">¶</a></h1>
<p>To start off, it is helpful to just dive into the code to show prediction power and then dive into the algorthims that make it possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import the package</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>

<span class="c1">#set up some data points</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>

<span class="c1">#fit the model</span>

<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="c1">#now predict on some new values</span>

<span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="support-vectors">
<h1><span class="section-number">10.11. </span>Support Vectors<a class="headerlink" href="#support-vectors" title="Permalink to this headline">¶</a></h1>
<p>Support vectors are data points that are closer to the hyperplane and influence the position and orientation of the hyperplane. Using these support vectors, we maximize the margin of the classifier. Deleting the support vectors will change the position of the hyperplane.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## get support vectors</span>
<span class="n">clf</span><span class="o">.</span><span class="n">support_vectors_</span>

<span class="c1">## get indices of support vectors</span>
<span class="n">clf</span><span class="o">.</span><span class="n">support_</span>

<span class="c1">## get number of support vectors for each class</span>
<span class="n">clf</span><span class="o">.</span><span class="n">n_support_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 1], dtype=int32)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="other-support-vector-machines">
<h1><span class="section-number">10.12. </span>Other Support Vector Machines<a class="headerlink" href="#other-support-vector-machines" title="Permalink to this headline">¶</a></h1>
<p>There are also other SVMs that can serve other purposes. Another main subset of
SVMs is called SVR (Support Vector Regression). It uses the same method as SVC,
however it solves regression problems instead of classification.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]</span>
<span class="n">regr</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVR</span><span class="p">()</span>
<span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.5])
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><p>In this case the fit method will still take in argument vectors X and y, but now y will be expected to have floating point values instead of integer values.</p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="misclassification">
<h1><span class="section-number">10.13. </span>Misclassification<a class="headerlink" href="#misclassification" title="Permalink to this headline">¶</a></h1>
<p>SVM allows for misclassifcation. This means that it is acceptable to have some
vectors fall inside the margin and on the wrong side of the decision
boundary. This is done so the model can do a better job at classifying most
vectors in the testing set.</p>
<p>Slack Variable: Tells us if a test observation is misclassified and where the
observation is relative to the decision boundary and the margin. If the value is
0, it means the point is correctly classified. If the slack variable is greater
than zero and less than one, then the point is on the wrong side of the
margin. Lastly if the variable is greater than 1, then the point is on the wrong
side of the hyperplane.</p>
</div>
<div class="section" id="in-practice">
<h1><span class="section-number">10.14. </span>In Practice<a class="headerlink" href="#in-practice" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> 
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>


<span class="n">job_app_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/nyc_DobJobApp_2021.csv&quot;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;unicode&quot;</span><span class="p">)</span>

<span class="n">job_app_data</span> <span class="o">=</span> <span class="n">job_app_data</span><span class="p">[[</span><span class="s1">&#39;Job Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Borough&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Status&#39;</span><span class="p">]]</span>
<span class="n">job_app_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;job_type&#39;</span><span class="p">,</span> <span class="s1">&#39;borough&#39;</span><span class="p">,</span> <span class="s1">&#39;job_status&#39;</span><span class="p">]</span>

<span class="n">job_app_data</span><span class="p">[</span><span class="s1">&#39;borough&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;MANHATTAN&#39;</span><span class="p">,</span> <span class="s1">&#39;BRONX&#39;</span><span class="p">,</span> <span class="s1">&#39;BROOKLYN&#39;</span><span class="p">,</span> <span class="s1">&#39;QUEENS&#39;</span><span class="p">,</span> <span class="s1">&#39;STATEN ISLAND&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">job_app_data</span><span class="p">[</span><span class="s1">&#39;job_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_app_data</span><span class="p">[</span><span class="s1">&#39;job_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>

<span class="n">job_app_data</span> <span class="o">=</span> <span class="n">job_app_data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">job_app_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;job_status&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">job_app_data</span><span class="p">[</span><span class="s1">&#39;job_status&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.20</span><span class="p">)</span>

<span class="n">svclassifier</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">svclassifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">svclassifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="c1">## print(classification_report(y_test))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[144   0]
 [ 56   0]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="for-additional-info">
<h1><span class="section-number">10.15. </span>For Additional Info<a class="headerlink" href="#for-additional-info" title="Permalink to this headline">¶</a></h1>
<p>Visit:
<a class="reference external" href="https://scikit-learn.org/stable/modules/svm.html#svm">https://scikit-learn.org/stable/modules/svm.html#svm</a>;
<a class="reference external" href="https://towardsdatascience.com/support-vector-machines-explained-with-python-examples-cb65e8172c85">https://towardsdatascience.com/support-vector-machines-explained-with-python-examples-cb65e8172c85</a></p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="bagging_vs_boosting.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">10.4. </span>Bagging versus Boosting</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="nearest_neighbor.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">10.16. </span>K Nearest Neighbor</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Jun Yan and students in STAT 5255/3255, Spring 2022<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>